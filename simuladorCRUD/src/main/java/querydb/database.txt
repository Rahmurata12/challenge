-- Gerado por Oracle SQL Developer Data Modeler 22.2.0.165.1149
--   em:        2022-09-29 17:42:52 BRT
--   site:      Oracle Database 11g
--   tipo:      Oracle Database 11g



-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE bairro (
    cd_bairro        NUMBER(7) NOT NULL,
    bairro           VARCHAR2(30) NOT NULL,
    cidade_cd_cidade NUMBER(7) NOT NULL
);

ALTER TABLE bairro ADD CONSTRAINT bairro_pk PRIMARY KEY ( cd_bairro );

CREATE TABLE cartao (
    cd_cartao      NUMBER(7) NOT NULL,
    tipo           VARCHAR2(10) NOT NULL,
    titulo_cartao  VARCHAR2(30) NOT NULL,
    data_expedicao DATE NOT NULL,
    cvv            NUMBER(3) NOT NULL,
    numero_cartao  NUMBER(16) NOT NULL,
    senha          NUMBER(4) NOT NULL,
    conta_cd_conta NUMBER(7) NOT NULL
);

ALTER TABLE cartao ADD CONSTRAINT cartao_pk PRIMARY KEY ( cd_cartao );

CREATE TABLE cidade (
    cd_cidade        NUMBER(7) NOT NULL,
    cidade           VARCHAR2(30) NOT NULL,
    estado_cd_estado NUMBER(3) NOT NULL
);

ALTER TABLE cidade ADD CONSTRAINT cidade_pk PRIMARY KEY ( cd_cidade );

CREATE TABLE compra (
    cd_compra      NUMBER(10) NOT NULL,
    data_compra    DATE NOT NULL,
    horario_compra  VARCHAR2(20) NOT NULL,
    status         VARCHAR2(10) NOT NULL,
    local_compra   VARCHAR2(30) NOT NULL,
    conta_cd_conta NUMBER(7) NOT NULL
);

ALTER TABLE compra ADD CONSTRAINT compra_pk PRIMARY KEY ( cd_compra );

CREATE TABLE conta (
    renda_mensal     NUMBER(9, 2) NOT NULL,
    fatura_mensal    VARCHAR2(20) NOT NULL,
    pessoa_cd_pessoa NUMBER(7) NOT NULL,
    cd_conta         NUMBER(7) NOT NULL
);

CREATE UNIQUE INDEX conta__idx ON
    conta (
        pessoa_cd_pessoa
    ASC );

ALTER TABLE conta ADD CONSTRAINT conta_pk PRIMARY KEY ( cd_conta );

CREATE TABLE estado (
    cd_estado    NUMBER(3) NOT NULL,
    estado       VARCHAR2(20) NOT NULL,
    pais_cd_pais NUMBER(2) NOT NULL
);

ALTER TABLE estado ADD CONSTRAINT estado_pk PRIMARY KEY ( cd_estado );

CREATE TABLE genero (
    cd_genero NUMBER(2) NOT NULL,
    genero    VARCHAR2(15) NOT NULL
);

ALTER TABLE genero ADD CONSTRAINT genero_pk PRIMARY KEY ( cd_genero );

CREATE TABLE login (
    usuario          VARCHAR2(30) NOT NULL,
    senha            VARCHAR2(30) NOT NULL,
    cd_login         NUMBER(7) NOT NULL,
    pessoa_cd_pessoa NUMBER(7) NOT NULL
);

CREATE UNIQUE INDEX login__idx ON
    login (
        pessoa_cd_pessoa
    ASC );

ALTER TABLE login ADD CONSTRAINT login_pk PRIMARY KEY ( cd_login );

CREATE TABLE pais (
    cd_pais NUMBER(2) NOT NULL,
    pais    VARCHAR2(20) NOT NULL
);

ALTER TABLE pais ADD CONSTRAINT pais_pk PRIMARY KEY ( cd_pais );

CREATE TABLE pessoa (
    cd_pessoa        NUMBER(7) NOT NULL,
    nome             VARCHAR2(30) NOT NULL,
    rg               VARCHAR2(30) NOT NULL,
    cpf              VARCHAR2(30) NOT NULL,
    data_nascimento  DATE NOT NULL,
    genero_cd_genero NUMBER(2) NOT NULL
);

CREATE UNIQUE INDEX pessoa__idx ON
    pessoa (
        genero_cd_genero
    ASC );

ALTER TABLE pessoa ADD CONSTRAINT pessoa_pk PRIMARY KEY ( cd_pessoa );

CREATE TABLE residencia (
    cd_residencia    NUMBER(7) NOT NULL,
    cep              NUMBER(8) NOT NULL,
    pessoa_cd_pessoa NUMBER(7) NOT NULL,
    rua_cd_rua       NUMBER(7) NOT NULL
);

CREATE UNIQUE INDEX residencia__idxv1 ON
    residencia (
        rua_cd_rua
    ASC );

CREATE UNIQUE INDEX residencia__idx ON
    residencia (
        rua_cd_rua
    ASC );

ALTER TABLE residencia ADD CONSTRAINT residencia_pk PRIMARY KEY ( cd_residencia );

CREATE TABLE rua (
    cd_rua           NUMBER(7) NOT NULL,
    rua              VARCHAR2(30) NOT NULL,
    bairro_cd_bairro NUMBER(7) NOT NULL
);

ALTER TABLE rua ADD CONSTRAINT rua_pk PRIMARY KEY ( cd_rua );

CREATE TABLE telefone (
    cd_telefone      NUMBER(2) NOT NULL,
    tipo             VARCHAR2(20) NOT NULL,
    numero           VARCHAR2(14) NOT NULL,
    pessoa_cd_pessoa NUMBER(7) NOT NULL
);

CREATE SEQUENCE contaa_sequence START WITH 1 INCREMENT BY 1;

CREATE OR REPLACE TRIGGER tr_insert_cd_conta
BEFORE INSERT ON conta FOR EACH ROW
BEGIN

SELECT contaa_sequence.NEXTVAL
INTO :NEW.cd_conta
FROM DUAL;
END;
/ 

CREATE SEQUENCE cdpessoa_sequence START WITH 1 INCREMENT BY 1;

CREATE OR REPLACE TRIGGER tr_insert_cd_pessoa
BEFORE INSERT ON pessoa FOR EACH ROW
BEGIN
 
SELECT cdpessoa_sequence.NEXTVAL
INTO :NEW.cd_pessoa
FROM DUAL;
END;
/

CREATE SEQUENCE login_sequence START WITH 1 INCREMENT BY 1;

CREATE OR REPLACE TRIGGER tr_insert_cd_login
BEFORE INSERT ON login FOR EACH ROW
BEGIN
 
SELECT login_sequence.NEXTVAL
INTO :NEW.cd_login
FROM DUAL;
END;
/
ALTER TABLE telefone ADD CONSTRAINT telefone_pk PRIMARY KEY ( cd_telefone );

ALTER TABLE bairro
    ADD CONSTRAINT bairro_cidade_fk FOREIGN KEY ( cidade_cd_cidade )
        REFERENCES cidade ( cd_cidade );

ALTER TABLE cartao
    ADD CONSTRAINT cartao_conta_fk FOREIGN KEY ( conta_cd_conta )
        REFERENCES conta ( cd_conta );

ALTER TABLE cidade
    ADD CONSTRAINT cidade_estado_fk FOREIGN KEY ( estado_cd_estado )
        REFERENCES estado ( cd_estado );

ALTER TABLE compra
    ADD CONSTRAINT compra_conta_fk FOREIGN KEY ( conta_cd_conta )
        REFERENCES conta ( cd_conta );

ALTER TABLE conta
    ADD CONSTRAINT conta_pessoa_fk FOREIGN KEY ( pessoa_cd_pessoa )
        REFERENCES pessoa ( cd_pessoa );

ALTER TABLE estado
    ADD CONSTRAINT estado_pais_fk FOREIGN KEY ( pais_cd_pais )
        REFERENCES pais ( cd_pais );

ALTER TABLE login
    ADD CONSTRAINT login_pessoa_fk FOREIGN KEY ( pessoa_cd_pessoa )
        REFERENCES pessoa ( cd_pessoa );

ALTER TABLE pessoa
    ADD CONSTRAINT pessoa_genero_fk FOREIGN KEY ( genero_cd_genero )
        REFERENCES genero ( cd_genero );

ALTER TABLE residencia
    ADD CONSTRAINT residencia_pessoa_fk FOREIGN KEY ( pessoa_cd_pessoa )
        REFERENCES pessoa ( cd_pessoa );

ALTER TABLE residencia
    ADD CONSTRAINT residencia_rua_fk FOREIGN KEY ( rua_cd_rua )
        REFERENCES rua ( cd_rua );

ALTER TABLE rua
    ADD CONSTRAINT rua_bairro_fk FOREIGN KEY ( bairro_cd_bairro )
        REFERENCES bairro ( cd_bairro );

ALTER TABLE telefone
    ADD CONSTRAINT telefone_pessoa_fk FOREIGN KEY ( pessoa_cd_pessoa )
        REFERENCES pessoa ( cd_pessoa );



-- Relat√≥rio do Resumo do Oracle SQL Developer Data Modeler: 
-- 
-- CREATE TABLE                            13
-- CREATE INDEX                             5
-- ALTER TABLE                             25
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
